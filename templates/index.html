{% extends "base.html" %}

{% block content %}
<div class="game-wrapper" 
     style="background-image: url('{{ url_for('static', filename='images/' + gamification.bg_image) }}');">

  <header class="game-header">
    <div class="user-profile">
      <div class="avatar">ğŸ‘¤</div> 
      <div class="user-info">
        <span class="username">Ivo</span>
        <div class="level-indicator">
          <span class="level-badge">NÃ­vel {{ gamification.level }}</span>
          <div class="progress-bar">
            <div class="fill" style="width: {{ (total % 20) * 5 }}%"></div>
          </div>
        </div>
      </div>
    </div>

    <nav class="top-nav">
      <a href="{{ url_for('index') }}" class="nav-btn active">ğŸ  InÃ­cio</a>
      <a href="#" class="nav-btn">ğŸ† Ranking</a>
      <a href="#" class="nav-btn">ğŸ“Š Stats</a>
      <a href="#" class="nav-btn">ğŸ“š BaÃº</a>
    </nav>
  </header>

  <main class="game-main">
    <div class="chest-display">
      <img src="{{ url_for('static', filename='images/' + gamification.chest_image) }}" 
           alt="BaÃº do Tesouro" 
           class="chest-anim">
      
      <div class="chest-message">
        <h2>{{ gamification.title }}</h2>
        <p>VocÃª tem <strong>{{ total }}</strong> frases guardadas.</p>
      </div>
    </div>
  </main>

  <footer class="game-actions">
    
    <button class="action-btn add-btn" onclick="document.getElementById('add-modal').showModal()">
      â• Adicionar
    </button>

    <a href="{{ url_for('study_session') }}" class="action-btn study-btn" role="button">
      âš”ï¸ Estudar
      {% if due_count > 0 %}
        <span class="notification-badge">{{ due_count }}</span>
      {% endif %}
    </a>

  </footer>

</div>

<dialog id="add-modal">
  <article>
    <header>
      <h3>Adicionar ao BaÃº</h3>
      <button aria-label="Close" rel="prev" onclick="this.closest('dialog').close()"></button>
    </header>
    <form action="{{ url_for('add') }}" method="POST">
      <label>
        Frase
        <input type="text" name="term" placeholder="Ex: We need to move onwards" required>
      </label>
      <label>
        Significado / TraduÃ§Ã£o
        <input type="text" name="meaning" placeholder="Ex: Precisamos seguir em frente">
      </label>
      <label>
        Palavra Foco (Opcional)
        <input type="text" name="target_word" placeholder="Ex: onwards">
      </label>
      
      <footer>
        <button type="button" class="secondary" onclick="this.closest('dialog').close()">Cancelar</button>
        <button type="submit">Salvar no BaÃº</button>
      </footer>
    </form>
  </article>
</dialog>
{% endblock %}